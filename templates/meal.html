<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Meal Plan</title>
    <link rel="stylesheet" href="../static/css/meal.css">
</head>
<body>
    <header>
        <div class="header-content">
            <a href="{{ url_for('home') }}" class="back-link">â¬…ï¸ë’¤ë¡œê°€ê¸°</a>
            <h1>ğŸ‘¨â€ğŸ³ ì˜ìˆ˜ì¦ ì…°í”„ ğŸ§¾</h1>
        </div>
    </header>
    
    <h1>ğŸ‘¨â€ğŸ³ ì¼ì£¼ì¼ ì‹ë‹¨ì€ ì œê°€ ì±…ì„ì§ˆê²Œìš” ğŸ˜‹</h1>
    <div id="meal-plan-container" class="meal-plan">
        <!-- JavaScriptë¡œ ìš”ì¼ë³„ ì‹ë‹¨ì´ ì¶”ê°€ë  ì˜ì—­ -->
    </div>

    <script>
        // ì„œë²„ì—ì„œ ì „ë‹¬ëœ meal_plan í…ìŠ¤íŠ¸ ì˜ˆì‹œ
        const mealPlanText = `{{ meal_plan | safe }}`;

        // ìš”ì¼ë³„ë¡œ í…ìŠ¤íŠ¸ë¥¼ ë¶„ë¦¬í•˜ê³  êµ¬ì¡°í™”ëœ HTMLì„ ìƒì„±í•˜ì—¬ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
        function displayMealPlan(text) {
            const container = document.getElementById('meal-plan-container');
            const daysOfWeek = ["ì›”ìš”ì¼", "í™”ìš”ì¼", "ìˆ˜ìš”ì¼", "ëª©ìš”ì¼", "ê¸ˆìš”ì¼", "í† ìš”ì¼", "ì¼ìš”ì¼"];
            let mealPlanHtml = '';
            let currentDay = '';
            let currentContent = '';

            // ì¤„ë°”ê¿ˆì„ ê¸°ì¤€ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ë¼ì¸ë³„ë¡œ ë¶„ë¦¬
            const lines = text.split('\n');

            lines.forEach(line => {
                // ìš”ì¼ì´ í¬í•¨ëœ ë¼ì¸ì„ ì°¾ì•„ ìš”ì¼ë³„ë¡œ êµ¬ë¶„
                if (daysOfWeek.some(day => line.includes(day))) {
                    if (currentDay) {
                        // í˜„ì¬ ìš”ì¼ê³¼ ë‚´ìš©ì„ HTMLì— ì¶”ê°€
                        mealPlanHtml += `
                            <div class="day-card">
                                â˜€ï¸ <h2 class="day-title"> ${currentDay}</h2>
                                <div class="recipe-info">${currentContent.trim()}</div>
                            </div>
                        `;
                    }
                    // ìƒˆë¡œìš´ ìš”ì¼ë¡œ ì´ˆê¸°í™”
                    currentDay = line.trim();
                    currentContent = '';
                } else {
                    // ë‚´ìš©ì´ ê³„ì† ì´ì–´ì§€ë©´ currentContentì— ì¶”ê°€
                    currentContent += line + '<br>';
                }
            });

            // ë§ˆì§€ë§‰ ìš”ì¼ ì¶”ê°€
            if (currentDay) {
                mealPlanHtml += `
                    <div class="day-card">
                        <h2 class="day-title">${currentDay}</h2>
                        <div class="recipe-info">${currentContent.trim()}</div>
                    </div>
                `;
            }

            // ìƒì„±ëœ HTMLì„ ì»¨í…Œì´ë„ˆì— ì‚½ì…
            container.innerHTML = mealPlanHtml;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹ë‹¨ í‘œì‹œ
        window.onload = () => displayMealPlan(mealPlanText);
    </script>
</body>
</html>
